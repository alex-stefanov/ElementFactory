@using ElementFactory.Models.Others;
@using ElementFactory.Data.Models;

@model AddQuestionsChooseModel;

@{
    ViewBag.Title = "Селектирайте въпроси";
}
<div class="selectQuestionsContainerDiv">
    @foreach (Question question in Model.Questions)
    {
        <div class="selectQuestionsContainer">
            @{
                string id = $"checkbox{question.Id}";
 }
            <input type="checkbox" 
                   id="@id"
                   onclick='{
                                if(document.getElementById("@id").checked)
                                {
                                    @{Model.Questions.Add(question);}
                                    console.log(@question);
                                }
                                else
                                {
                                    @{Model.Questions.Remove(question);}
                                }
                            }' />

            <span class="selectQuestionsDescription">@question.Description</span>
            
            @foreach (Answer answer in question.Answers)
            {
                <span class="selectQuestionsAnswer">@answer.Value</span>
            }
        </div>
    }
    <button class="selectQuestionsAnchor" onclick="CheckQuestions(@Model.NumberOfQ)">Добави въпроси</button>
  
    <div class="validationErrorDivSmall">
        Невалиден брой въпроси! 
        Изберете по-малък брой!
    </div>

    <div class="validationErrorDivBig">
        Невалиден брой въпроси!
        Изберете по-голям брой!
    </div>
</div>

<script>
    document.getElementsByTagName('body')[0].classList.add('scrollClass');
    var errorDivSmall = document
        .getElementsByClassName('validationErrorDivSmall')[0];
    errorDivSmall.style.display = 'none';

    var errorDivBig = document.getElementsByClassName('validationErrorDivBig')[0];
    errorDivBig.style.display = 'none';

    function CheckQuestions(neededLength, title, ) {
        var selected = Array.from(document.querySelectorAll('input[type=checkbox]:checked'));

        if (selected.length > neededLength) {
            errorDivSmall.classList.add('errorDivSmall');
            errorDivSmall.style.display = 'block';

            setTimeout(function () {
                errorDivSmall.style.display = 'none';
                errorDivSmall.classList.remove('errorDivSmall');
            }, 2000);
        }
        else if (selected.length < neededLength) {
            errorDivBig.classList.add('errorDivBig');
            errorDivBig.style.display = 'block';

            setTimeout(function () {
                errorDivBig.classList.remove('errorDivBig');
            }, 2000);
        }
        else {

        }
    }
</script>